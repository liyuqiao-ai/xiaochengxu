# é¡¹ç›®æœªå®Œæˆé¡¹å…¨é¢æ£€æŸ¥æ¸…å•

## ğŸ”´ é«˜ä¼˜å…ˆçº§ - å¿…é¡»å®Œæˆ

### 1. ç¼ºå¤±çš„äº‘å‡½æ•°

#### 1.1 ç”¨æˆ·è®¤è¯ç›¸å…³
- [ ] **`getOpenId`** - è·å–ç”¨æˆ·openid
  - **ä½ç½®**: `cloud-functions/user/getOpenId/`
  - **è°ƒç”¨ä½ç½®**: `cloud-functions/user/loginUser/index.ts:34`
  - **åŠŸèƒ½**: é€šè¿‡å¾®ä¿¡codeè·å–openid
  - **å½±å“**: ç”¨æˆ·æ— æ³•ç™»å½•

#### 1.2 å›¢é˜Ÿç®¡ç†ç›¸å…³
- [ ] **`joinTeam`** - å·¥äººåŠ å…¥å›¢é˜Ÿ
  - **ä½ç½®**: `cloud-functions/worker/joinTeam/`
  - **è°ƒç”¨ä½ç½®**: `miniprogram/worker/pages/task-detail/task-detail.ts:82`
  - **åŠŸèƒ½**: å·¥äººç”³è¯·åŠ å…¥å·¥å¤´å›¢é˜Ÿ
  - **å½±å“**: å·¥äººæ— æ³•åŠ å…¥å›¢é˜Ÿ

- [ ] **`getTeamMembers`** - è·å–å›¢é˜Ÿæˆå‘˜
  - **ä½ç½®**: `cloud-functions/contractor/getTeamMembers/`
  - **è°ƒç”¨ä½ç½®**: `miniprogram/contractor/pages/team/team.ts:42`
  - **åŠŸèƒ½**: å·¥å¤´æŸ¥çœ‹å›¢é˜Ÿæˆå‘˜åˆ—è¡¨
  - **å½±å“**: å·¥å¤´æ— æ³•æŸ¥çœ‹å›¢é˜Ÿ

- [ ] **`getPendingRequests`** - è·å–å…¥é˜Ÿç”³è¯·
  - **ä½ç½®**: `cloud-functions/contractor/getPendingRequests/`
  - **è°ƒç”¨ä½ç½®**: `miniprogram/contractor/pages/team/team.ts:55`
  - **åŠŸèƒ½**: å·¥å¤´æŸ¥çœ‹å¾…å®¡æ ¸çš„å…¥é˜Ÿç”³è¯·
  - **å½±å“**: å·¥å¤´æ— æ³•å®¡æ ¸ç”³è¯·

- [ ] **`reviewTeamRequest`** - å®¡æ ¸å›¢é˜Ÿç”³è¯·
  - **ä½ç½®**: `cloud-functions/contractor/reviewTeamRequest/`
  - **è°ƒç”¨ä½ç½®**: `miniprogram/contractor/pages/team/team.ts:86`
  - **åŠŸèƒ½**: å·¥å¤´å®¡æ ¸å·¥äººçš„å…¥é˜Ÿç”³è¯·ï¼ˆåŒæ„/æ‹’ç»ï¼‰
  - **å½±å“**: å·¥å¤´æ— æ³•å®¡æ ¸ç”³è¯·

- [ ] **`removeTeamMember`** - ç§»é™¤å›¢é˜Ÿæˆå‘˜
  - **ä½ç½®**: `cloud-functions/contractor/removeTeamMember/`
  - **è°ƒç”¨ä½ç½®**: `miniprogram/contractor/pages/team/team.ts:132`
  - **åŠŸèƒ½**: å·¥å¤´ç§»é™¤å›¢é˜Ÿæˆå‘˜
  - **å½±å“**: å·¥å¤´æ— æ³•ç®¡ç†å›¢é˜Ÿ

#### 1.3 å·¥äººç»Ÿè®¡ç›¸å…³
- [ ] **`getWorkerStats`** - è·å–å·¥äººç»Ÿè®¡æ•°æ®
  - **ä½ç½®**: `cloud-functions/worker/getWorkerStats/`
  - **è°ƒç”¨ä½ç½®**: `miniprogram/worker/pages/profile/profile.ts:41`
  - **åŠŸèƒ½**: è·å–å·¥äººçš„ä»»åŠ¡æ•°ã€æ”¶å…¥ã€ä¿¡ç”¨åˆ†ç­‰ç»Ÿè®¡
  - **å½±å“**: å·¥äººæ— æ³•æŸ¥çœ‹ç»Ÿè®¡æ•°æ®

### 2. ç¼ºå¤±çš„é¡µé¢é…ç½®æ–‡ä»¶

- [ ] **`miniprogram/farmer/pages/publish-demand/publish-demand.json`**
  - **å½±å“**: é¡µé¢å¯èƒ½æ— æ³•æ­£å¸¸æ˜¾ç¤ºå¯¼èˆªæ ç­‰é…ç½®

### 3. é€šçŸ¥ç³»ç»Ÿå®ç°

- [ ] **`cloud-functions/notification/sendNotification/index.ts`**
  - **å½“å‰çŠ¶æ€**: åªæœ‰æ¡†æ¶ï¼ŒTODOæ ‡è®°
  - **éœ€è¦å®ç°**:
    - [ ] å¾®ä¿¡æ¨¡æ¿æ¶ˆæ¯å‘é€
    - [ ] å°ç¨‹åºè®¢é˜…æ¶ˆæ¯
    - [ ] ç«™å†…é€šçŸ¥ä¿å­˜
    - [ ] é€šçŸ¥ç±»å‹è·¯ç”±ï¼ˆnew_demand, new_quote, quote_acceptedç­‰ï¼‰

- [ ] **é€šçŸ¥è°ƒç”¨ç‚¹**ï¼ˆå·²æ·»åŠ ä½†æœªå®ç°ï¼‰:
  - `cloud-functions/order/createOrder/index.ts:84`
  - `cloud-functions/order/submitQuote/index.ts:89`
  - `cloud-functions/order/acceptQuote/index.ts:90`
  - `cloud-functions/order/cancelOrder/index.ts:78`
  - `cloud-functions/order/updateOrderStatus/index.ts:31`
  - `cloud-functions/order/completeOrder/index.ts:68`
  - `cloud-functions/order/startWork/index.ts:59`
  - `cloud-functions/order/updateProgress/index.ts:68`

## ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ - é‡è¦åŠŸèƒ½

### 4. åœ°ç†ä½ç½®åŠŸèƒ½

- [ ] **`cloud-functions/worker/getNearbyTasks/index.ts:51`**
  - **åŠŸèƒ½**: æ ¹æ®åœ°ç†ä½ç½®ç­›é€‰é™„è¿‘çš„ä»»åŠ¡
  - **å½“å‰çŠ¶æ€**: TODOæ ‡è®°ï¼Œè¿”å›æ‰€æœ‰è®¢å•
  - **éœ€è¦å®ç°**: 
    - [ ] è®¡ç®—ä¸¤ç‚¹é—´è·ç¦»
    - [ ] æ ¹æ®åŠå¾„ç­›é€‰
    - [ ] æŒ‰è·ç¦»æ’åº

- [ ] **`miniprogram/farmer/pages/publish-demand/publish-demand.ts:37`**
  - **åŠŸèƒ½**: é€†åœ°ç†ç¼–ç è·å–è¯¦ç»†åœ°å€
  - **å½“å‰çŠ¶æ€**: TODOæ ‡è®°
  - **éœ€è¦å®ç°**: è°ƒç”¨è…¾è®¯åœ°å›¾APIæˆ–å¾®ä¿¡åœ°å›¾API

### 5. å‰ç«¯åŠŸèƒ½å®Œå–„

- [ ] **è”ç³»å·¥å¤´åŠŸèƒ½**
  - **ä½ç½®**: `miniprogram/worker/pages/task-detail/task-detail.ts:136`
  - **åŠŸèƒ½**: å·¥äººè”ç³»å·¥å¤´ï¼ˆç”µè¯/å¾®ä¿¡ï¼‰
  - **éœ€è¦å®ç°**: è·å–å·¥å¤´è”ç³»æ–¹å¼å¹¶å±•ç¤º

- [ ] **äºŒç»´ç ç”ŸæˆåŠŸèƒ½**
  - **ä½ç½®**: `miniprogram/introducer/pages/index/index.ts:103`
  - **åŠŸèƒ½**: ä»‹ç»æ–¹ç”Ÿæˆæ¨å¹¿äºŒç»´ç 
  - **éœ€è¦å®ç°**: ä½¿ç”¨å¾®ä¿¡å°ç¨‹åºç APIç”ŸæˆäºŒç»´ç 

- [ ] **å¤šæŠ¥ä»·æ¨¡å¼**
  - **ä½ç½®**: `miniprogram/farmer/pages/quotes/quotes.ts:47`
  - **å½“å‰çŠ¶æ€**: TODOæ ‡è®°ï¼Œç›®å‰åªæ”¯æŒå•ä¸ªæŠ¥ä»·
  - **éœ€è¦å®ç°**: æ”¯æŒä¸€ä¸ªè®¢å•å¤šä¸ªå·¥å¤´æŠ¥ä»·

### 6. æµ‹è¯•è¦†ç›–

- [ ] **é›†æˆæµ‹è¯•å®ç°**
  - **ä½ç½®**: `tests/integration/orderFlow.test.ts:16`
  - **å½“å‰çŠ¶æ€**: åªæœ‰æ¡†æ¶
  - **éœ€è¦å®ç°**:
    - [ ] å®Œæ•´è®¢å•æµç¨‹æµ‹è¯•
    - [ ] æ”¯ä»˜æµç¨‹æµ‹è¯•
    - [ ] çŠ¶æ€è½¬æ¢æµ‹è¯•
    - [ ] å¹¶å‘åœºæ™¯æµ‹è¯•

- [ ] **æµ‹è¯•ä¾èµ–**
  - **é—®é¢˜**: `package.json`ç¼ºå°‘jestç›¸å…³ä¾èµ–
  - **éœ€è¦æ·»åŠ **:
    ```json
    "jest": "^29.0.0",
    "ts-jest": "^29.0.0",
    "@types/jest": "^29.0.0"
    ```

## ğŸŸ¢ ä½ä¼˜å…ˆçº§ - ä¼˜åŒ–é¡¹

### 7. æ•°æ®åº“è¿ç§»

- [ ] **æ•°æ®è¿ç§»è„šæœ¬**
  - **ä½ç½®**: `docs/database-init.md:114`
  - **åŠŸèƒ½**: æ•°æ®åº“ç»“æ„å˜æ›´æ—¶çš„è¿ç§»é€»è¾‘
  - **å½“å‰çŠ¶æ€**: TODOæ ‡è®°

### 8. æ€§èƒ½ä¼˜åŒ–

- [ ] **ç¼“å­˜ç­–ç•¥**
  - ç”¨æˆ·ä¿¡æ¯ç¼“å­˜
  - è®¢å•åˆ—è¡¨ç¼“å­˜
  - ç»Ÿè®¡æ•°æ®ç¼“å­˜

- [ ] **æŸ¥è¯¢ä¼˜åŒ–**
  - åœ°ç†ä½ç½®ç´¢å¼•
  - å¤åˆç´¢å¼•ä¼˜åŒ–
  - åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–

### 9. å®‰å…¨åŠ å›º

- [ ] **å®Œæ•´çš„é¢‘ç‡é™åˆ¶ç³»ç»Ÿ**
  - å½“å‰åªæœ‰åŸºç¡€å®ç°
  - éœ€è¦æŒ‰æ¥å£ã€æŒ‰ç”¨æˆ·ç»†åŒ–

- [ ] **æ“ä½œæ—¥å¿—è®°å½•**
  - å…³é”®æ“ä½œå®¡è®¡æ—¥å¿—
  - å¼‚å¸¸è¡Œä¸ºè®°å½•

- [ ] **å¼‚å¸¸è¡Œä¸ºæ£€æµ‹**
  - å¼‚å¸¸ç™»å½•æ£€æµ‹
  - å¼‚å¸¸è®¢å•æ£€æµ‹

### 10. ç›‘æ§å’Œè¿ç»´

- [ ] **æ—¥å¿—ç³»ç»Ÿå®Œå–„**
  - ç»“æ„åŒ–æ—¥å¿—
  - æ—¥å¿—åˆ†çº§
  - æ—¥å¿—èšåˆ

- [ ] **ç›‘æ§å‘Šè­¦é…ç½®**
  - ä¸šåŠ¡ç›‘æ§
  - æ€§èƒ½ç›‘æ§
  - é”™è¯¯ç›‘æ§

- [ ] **æ•°æ®å¤‡ä»½ç­–ç•¥**
  - è‡ªåŠ¨å¤‡ä»½
  - ç¾éš¾æ¢å¤é¢„æ¡ˆ

## ğŸ“‹ æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥

### ç¼ºå¤±çš„é…ç½®æ–‡ä»¶

- [ ] `miniprogram/farmer/pages/publish-demand/publish-demand.json`

### éœ€è¦æ£€æŸ¥çš„é¡µé¢æ–‡ä»¶

æ‰€æœ‰é¡µé¢åº”åŒ…å«4ä¸ªæ–‡ä»¶ï¼š
- `.ts` - é€»è¾‘æ–‡ä»¶
- `.wxml` - æ¨¡æ¿æ–‡ä»¶
- `.wxss` - æ ·å¼æ–‡ä»¶
- `.json` - é…ç½®æ–‡ä»¶

**éœ€è¦æ£€æŸ¥çš„é¡µé¢**:
- [ ] `miniprogram/farmer/pages/publish-demand/` - ç¼ºå°‘`.json`
- [ ] å…¶ä»–é¡µé¢æ–‡ä»¶å®Œæ•´æ€§ï¼ˆéœ€è¦é€ä¸ªæ£€æŸ¥ï¼‰

## ğŸ¯ ä¼˜å…ˆçº§æ€»ç»“

### ç«‹å³å®Œæˆï¼ˆé˜»å¡åŠŸèƒ½ï¼‰
1. âœ… `getOpenId` - ç”¨æˆ·æ— æ³•ç™»å½•
2. âœ… å›¢é˜Ÿç®¡ç†ç›¸å…³äº‘å‡½æ•° - å›¢é˜ŸåŠŸèƒ½å®Œå…¨ä¸å¯ç”¨
3. âœ… `getWorkerStats` - å·¥äººç»Ÿè®¡ä¸å¯ç”¨
4. âœ… `publish-demand.json` - é¡µé¢é…ç½®ç¼ºå¤±

### å°½å¿«å®Œæˆï¼ˆå½±å“ä½“éªŒï¼‰
5. âš ï¸ é€šçŸ¥ç³»ç»Ÿå®ç° - ç”¨æˆ·æ— æ³•æ”¶åˆ°é€šçŸ¥
6. âš ï¸ åœ°ç†ä½ç½®ç­›é€‰ - å·¥äººæ— æ³•æ‰¾åˆ°é™„è¿‘ä»»åŠ¡
7. âš ï¸ åœ°å›¾APIé›†æˆ - åœ°å€è·å–ä¸å‡†ç¡®

### åç»­ä¼˜åŒ–
8. ğŸ“ æµ‹è¯•ç”¨ä¾‹å®Œå–„
9. ğŸ“ æ€§èƒ½ä¼˜åŒ–
10. ğŸ“ ç›‘æ§è¿ç»´

## ğŸ“Š å®Œæˆåº¦ç»Ÿè®¡

### äº‘å‡½æ•°å®Œæˆåº¦
- **æ€»æ•°**: ~30ä¸ª
- **å·²å®ç°**: ~23ä¸ª
- **ç¼ºå¤±**: 7ä¸ª
- **å®Œæˆåº¦**: 77%

### å‰ç«¯é¡µé¢å®Œæˆåº¦
- **æ€»æ•°**: 16ä¸ªé¡µé¢
- **å®Œæ•´é¡µé¢**: 15ä¸ª
- **ç¼ºå¤±é…ç½®**: 1ä¸ª
- **å®Œæˆåº¦**: 94%

### æ ¸å¿ƒåŠŸèƒ½å®Œæˆåº¦
- **è®¢å•æµç¨‹**: 100% âœ…
- **æ”¯ä»˜ç³»ç»Ÿ**: 100% âœ…
- **æƒé™æ§åˆ¶**: 100% âœ…
- **é€šçŸ¥ç³»ç»Ÿ**: 20% âš ï¸
- **å›¢é˜Ÿç®¡ç†**: 30% âš ï¸
- **åœ°ç†ä½ç½®**: 50% âš ï¸

### æ•´ä½“å®Œæˆåº¦
- **æ ¸å¿ƒä¸šåŠ¡**: 90%
- **è¾…åŠ©åŠŸèƒ½**: 60%
- **æµ‹è¯•è¦†ç›–**: 20%
- **è¿ç»´ç›‘æ§**: 30%

## ğŸ”§ å»ºè®®å®æ–½é¡ºåº

### ç¬¬ä¸€é˜¶æ®µï¼ˆ1-2å¤©ï¼‰
1. å®ç° `getOpenId` äº‘å‡½æ•°
2. å®ç°å›¢é˜Ÿç®¡ç†ç›¸å…³äº‘å‡½æ•°ï¼ˆ5ä¸ªï¼‰
3. å®ç° `getWorkerStats` äº‘å‡½æ•°
4. æ·»åŠ  `publish-demand.json` é…ç½®æ–‡ä»¶

### ç¬¬äºŒé˜¶æ®µï¼ˆ2-3å¤©ï¼‰
5. å®ç°é€šçŸ¥ç³»ç»Ÿæ ¸å¿ƒåŠŸèƒ½
6. å®ç°åœ°ç†ä½ç½®ç­›é€‰
7. é›†æˆåœ°å›¾API

### ç¬¬ä¸‰é˜¶æ®µï¼ˆ1-2å¤©ï¼‰
8. å®Œå–„å‰ç«¯åŠŸèƒ½ï¼ˆè”ç³»å·¥å¤´ã€äºŒç»´ç ç­‰ï¼‰
9. æ·»åŠ æµ‹è¯•ç”¨ä¾‹
10. æ€§èƒ½ä¼˜åŒ–

### ç¬¬å››é˜¶æ®µï¼ˆæŒç»­ï¼‰
11. ç›‘æ§è¿ç»´
12. å®‰å…¨åŠ å›º
13. æ–‡æ¡£å®Œå–„

