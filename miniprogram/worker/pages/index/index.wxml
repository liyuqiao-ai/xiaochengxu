<view class="container">
  <view class="header">
    <view class="user-info" wx:if="{{userInfo}}">
      <image class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
      <text class="nickname">{{userInfo.nickName}}</text>
    </view>
  </view>

  <!-- æ•°æ®ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="stat-item">
      <text class="stat-value">{{stats.nearbyTasksCount || 0}}</text>
      <text class="stat-label">é™„è¿‘ä»»åŠ¡</text>
    </view>
    <view class="stat-item">
      <text class="stat-value">{{stats.myTasksCount || 0}}</text>
      <text class="stat-label">æˆ‘çš„ä»»åŠ¡</text>
    </view>
  </view>

  <!-- é™„è¿‘ä»»åŠ¡ -->
  <view class="section">
    <view class="section-title">é™„è¿‘ä»»åŠ¡ ({{nearbyTasks.length}})</view>
    <view class="task-list">
      <view
        class="task-item"
        wx:for="{{nearbyTasks}}"
        wx:key="_id"
        bindtap="viewTaskDetail"
        data-task-id="{{item._id}}"
      >
        <view class="task-header">
          <text class="task-job">{{item.jobType}}</text>
          <text class="task-status">{{item.status}}</text>
        </view>
        <view class="task-info">
          <text class="task-location">ğŸ“ {{item.location.address}}</text>
          <text class="task-distance" wx:if="{{item.distance}}">{{item.distance}}km</text>
        </view>
        <view class="task-salary" wx:if="{{item.dailyInfo || item.pieceInfo}}">
          <text class="salary-label">è–ªèµ„ï¼š</text>
          <text class="salary-value">
            <text wx:if="{{item.pricingMode === 'daily'}}">{{item.dailyInfo.dailySalary / 100}} å…ƒ/å¤©</text>
            <text wx:if="{{item.pricingMode === 'piece'}}">{{item.pieceInfo.unitPrice / 100}} å…ƒ/{{item.pieceInfo.unit}}</text>
          </text>
        </view>
        <view class="task-actions">
          <button class="btn-join" size="mini" catchtap="joinTeam" data-contractor-id="{{item.contractorId}}">
            åŠ å…¥å›¢é˜Ÿ
          </button>
        </view>
      </view>
      <view class="empty" wx:if="{{nearbyTasks.length === 0}}">
        æš‚æ— é™„è¿‘ä»»åŠ¡
      </view>
    </view>
  </view>

  <!-- æˆ‘çš„ä»»åŠ¡ -->
  <view class="section">
    <view class="section-title">æˆ‘çš„ä»»åŠ¡</view>
    <view class="task-list">
      <view
        class="task-item"
        wx:for="{{myTasks}}"
        wx:key="_id"
        bindtap="viewTaskDetail"
        data-task-id="{{item._id}}"
      >
        <view class="task-header">
          <text class="task-job">{{item.jobType}}</text>
          <text class="task-status">{{item.status}}</text>
        </view>
        <view class="task-info">
          <text class="task-location">{{item.location.address}}</text>
        </view>
      </view>
      <view class="empty" wx:if="{{myTasks.length === 0}}">
        æš‚æ— ä»»åŠ¡
      </view>
    </view>
  </view>
</view>

