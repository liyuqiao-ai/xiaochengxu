<view class="container">
  <!-- 团队头部 -->
  <view class="team-header">
    <text class="team-title">团队管理</text>
    <button class="btn-scan" size="mini" bindtap="scanAddMember">扫码添加工人</button>
  </view>

  <!-- 团队统计 -->
  <view class="team-stats">
    <view class="stat-card">
      <text class="stat-number">{{teamStats.totalMembers || 0}}</text>
      <text class="stat-label">团队成员</text>
    </view>
    <view class="stat-card">
      <text class="stat-number">{{teamStats.pendingRequests || 0}}</text>
      <text class="stat-label">待审核申请</text>
    </view>
  </view>

  <!-- 标签页 -->
  <view class="tabs">
    <view
      class="tab-item {{activeTab === index ? 'active' : ''}}"
      wx:for="{{tabs}}"
      wx:key="index"
      wx:for-index="index"
      bindtap="onTabChange"
      data-index="{{index}}"
    >
      {{item}}
    </view>
  </view>

  <!-- 团队成员列表 -->
  <view class="team-sections">
    <view class="section" wx:if="{{activeTab === 0}}">
      <text class="section-title">团队成员</text>
      <view class="member-list">
        <view
          class="member-item"
          wx:for="{{teamMembers}}"
          wx:key="_id"
        >
          <image class="avatar" src="{{item.avatarUrl}}" mode="aspectFill"></image>
          <view class="member-info">
            <text class="member-name">{{item.realName || item.nickName}}</text>
            <text class="member-skills">{{item.skills ? item.skills.join(', ') : '暂无技能'}}</text>
            <text class="member-score">信用分: {{item.creditScore || 0}}</text>
          </view>
          <view class="member-actions">
            <button
              class="btn-assign"
              size="mini"
              bindtap="assignTask"
              data-member-id="{{item._id}}"
            >
              分配任务
            </button>
            <button
              class="btn-remove"
              size="mini"
              bindtap="removeMember"
              data-member-id="{{item._id}}"
            >
              移除
            </button>
          </view>
        </view>
        <view class="empty" wx:if="{{teamMembers.length === 0 && !loading}}">
          暂无团队成员
        </view>
      </view>
    </view>

    <!-- 待审核申请 -->
    <view class="section" wx:if="{{activeTab === 1}}">
      <text class="section-title">待审核申请</text>
      <view class="request-list">
        <view
          class="request-item"
          wx:for="{{pendingRequests}}"
          wx:key="_id"
        >
          <image class="avatar" src="{{item.workerAvatar || item.avatarUrl}}" mode="aspectFill"></image>
          <view class="request-info">
            <text class="worker-name">{{item.workerName || item.nickName}}</text>
            <text class="request-time">{{item.createdAt}}</text>
            <text class="request-message">{{item.message || '申请加入您的团队'}}</text>
          </view>
          <view class="request-actions">
            <button
              class="btn-approve"
              size="mini"
              bindtap="approveRequest"
              data-request-id="{{item._id}}"
            >
              同意
            </button>
            <button
              class="btn-reject"
              size="mini"
              bindtap="rejectRequest"
              data-request-id="{{item._id}}"
            >
              拒绝
            </button>
          </view>
        </view>
        <view class="empty" wx:if="{{pendingRequests.length === 0 && !loading}}">
          暂无入队申请
        </view>
      </view>
    </view>
  </view>
</view>

