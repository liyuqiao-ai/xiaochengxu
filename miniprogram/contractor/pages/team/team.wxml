<view class="team-management">
  <!-- å›¢é˜Ÿæ¦‚è§ˆ -->
  <view class="team-overview">
    <view class="overview-stats">
      <view class="stat-item">
        <text class="stat-number">{{teamStats.totalMembers || 0}}</text>
        <text class="stat-label">å›¢é˜Ÿæˆå‘˜</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{teamStats.activeMembers || 0}}</text>
        <text class="stat-label">åœ¨çº¿æˆå‘˜</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{teamStats.pendingRequests || 0}}</text>
        <text class="stat-label">å¾…å®¡æ ¸</text>
      </view>
    </view>
    <button class="btn-scan-member" bindtap="scanToAddMember">
      ğŸ“· æ‰«ç æ·»åŠ å·¥äºº
    </button>
  </view>

  <!-- æ ‡ç­¾é¡µ -->
  <view class="tabs">
    <view
      class="tab-item {{activeTab === index ? 'active' : ''}}"
      wx:for="{{tabs}}"
      wx:key="index"
      wx:for-index="index"
      bindtap="onTabChange"
      data-index="{{index}}"
    >
      {{item}}
    </view>
  </view>

  <!-- å›¢é˜Ÿæˆå‘˜åˆ—è¡¨ -->
  <view class="team-members-section">
    <view class="section-header">
      <text class="section-title">å›¢é˜Ÿæˆå‘˜ ({{teamMembers.length}})</text>
      <button class="btn-invite" bindtap="generateInviteLink">ç”Ÿæˆé‚€è¯·é“¾æ¥</button>
    </view>
    <view class="member-list">
      <view
        class="member-item"
        wx:for="{{teamMembers}}"
        wx:key="_id"
      >
        <image class="member-avatar" src="{{item.avatarUrl}}" mode="aspectFill"></image>
        <view class="member-info">
          <text class="member-name">{{item.realName || item.nickName}}</text>
          <text class="member-skills">æŠ€èƒ½: {{item.skills ? item.skills.join(', ') : 'æš‚æ— æŠ€èƒ½'}}</text>
          <text class="member-stats">
            ä¿¡ç”¨åˆ†: {{item.creditScore || 0}} | å®Œæˆè®¢å•: {{item.completedOrders || 0}}
          </text>
          <text class="member-status {{item.status || 'offline'}}">
            {{item.status === 'online' ? 'åœ¨çº¿' : 'ç¦»çº¿'}}
          </text>
        </view>
        <view class="member-actions">
          <button
            class="btn-assign"
            bindtap="assignTask"
            data-member-id="{{item._id}}"
          >
            ğŸ“‹ åˆ†é…ä»»åŠ¡
          </button>
          <button
            class="btn-chat"
            bindtap="chatWithMember"
            data-member-id="{{item._id}}"
          >
            ğŸ’¬ è”ç³»
          </button>
          <button
            class="btn-remove"
            bindtap="removeMember"
            data-member-id="{{item._id}}"
          >
            ğŸ—‘ï¸ ç§»é™¤
          </button>
        </view>
      </view>
    </view>
  </view>

    <!-- å¾…å®¡æ ¸ç”³è¯· -->
    <view class="pending-requests-section">
      <view class="section-header">
        <text class="section-title">å¾…å®¡æ ¸ç”³è¯· ({{pendingRequests.length}})</text>
        <button class="btn-view-all" bindtap="viewAllRequests">æŸ¥çœ‹å…¨éƒ¨</button>
      </view>
      <view class="request-list">
        <view
          class="request-item"
          wx:for="{{pendingRequests}}"
          wx:key="_id"
        >
          <image class="applicant-avatar" src="{{item.workerAvatar || item.avatarUrl}}" mode="aspectFill"></image>
          <view class="request-details">
            <text class="applicant-name">{{item.workerName || item.nickName}}</text>
            <text class="applicant-skills">{{item.skills ? item.skills.join(', ') : 'æš‚æ— æŠ€èƒ½'}}</text>
            <text class="request-time">ç”³è¯·æ—¶é—´: {{item.applyTime || item.createdAt}}</text>
            <text class="request-message">ç•™è¨€: {{item.message || 'æš‚æ— ç•™è¨€'}}</text>
          </view>
          <view class="request-actions">
            <button
              class="btn-approve"
              bindtap="approveRequest"
              data-request-id="{{item._id}}"
            >
              âœ… åŒæ„
            </button>
            <button
              class="btn-reject"
              bindtap="rejectRequest"
              data-request-id="{{item._id}}"
            >
              âŒ æ‹’ç»
            </button>
          </view>
        </view>
        <view class="empty-state" wx:if="{{pendingRequests.length === 0}}">
          <text>æš‚æ— å¾…å®¡æ ¸ç”³è¯·</text>
        </view>
      </view>
    </view>
  </view>
</view>

